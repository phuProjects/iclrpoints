<!DOCTYPE html> <!-- This is an HTML5 page -->
<html lang="en"> <!-- this page is in English-->
<head> <!-- <head> is where you put page setting title scripts -->
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ICLR Points</title>
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script> <!-- loads Plotly from internet. Plotly is chart library-->
</head>
<body> <!-- content user will see -->
    <div id="menu"></div>

    <h2>ICLR Points</h2>
    <p>How many ICLR publications is one paper in each area?</p>

    <div id="layout">

        <div id="chart"></div> <!-- chart -->

        <div id="sidebar"> <!--sidebar-->
            <div id="date-range"> <!--Date ranges-->
                <p>From: <input type="text" id="from-year" placeholder="2019"></p>
                <p>To: <input type="text" id="to-year" placeholder="2023"></p>
                <p><button id="update-range">Update</button></p>
            </div>

            <div id="checkboxes"> <!-- Check boxes-->
                <!--AI-->
                <input type="checkbox" checked> AI

                <div>
                    <input type="checkbox" checked> Artificial intelligence
                    <div><input type="checkbox" checked> AAAI</div>
                    <div><input type="checkbox" checked> IJCAI</div>
                </div>

                <div>
                    <input type="checkbox" checked> Computer vision
                    <div><input type="checkbox" checked> CVPR</div>
                    <div><input type="checkbox" checked> ECCV</div>
                    <div><input type="checkbox" checked> ICCV</div>
                </div>

                <div>
                    <input type="checkbox" checked> Machine learning
                    <div><input type="checkbox" checked> ICLR</div>
                    <div><input type="checkbox" checked> ICML</div>
                    <div><input type="checkbox" checked> NeurIPS</div>
                </div>

                <div><input type="checkbox"> KDD</div>

                <div>
                    <input type="checkbox" checked> Natural language processing
                    <div><input type="checkbox" checked> ACL</div>
                    <div><input type="checkbox" checked> EMNLP</div>
                    <div><input type="checkbox" checked> NAACL</div>
                </div>

                <div>
                    <input type="checkbox" checked> The Web & information retrieval
                    <div><input type="checkbox" checked> SIGIR</div>
                    <div><input type="checkbox" checked> WWW</div>
                </div>
                
                <!-- Systems -->
                <input type="checkbox" checked> Systems

                <div>
                    <input type="checkbox" checked> Computer architecture
                    <div><input type="checkbox" checked> ASPLOS</div>
                    <div><input type="checkbox" checked> ISCA</div>
                    <div><input type="checkbox" checked> MICRO</div>
                    <div><input type="checkbox" checked> HPCA</div>
                </div>

                <div>
                    <input type="checkbox" checked> Computer networks
                    <div><input type="checkbox" checked> SIGCOMM</div>
                    <div><input type="checkbox" checked> NSDI</div>
                </div>

                <div>
                    <input type="checkbox" checked> Computer security
                    <div><input type="checkbox" checked> CCS</div>
                    <div><input type="checkbox" checked> IEEE S&P</div>
                    <div><input type="checkbox" checked> USENIX Security</div>
                    <div><input type="checkbox" checked> NDSS</div>
                </div>
                
                <div>
                    <input type="checkbox" checked> Databases
                    <div><input type="checkbox" checked> SIGMOD</div>
                    <div><input type="checkbox" checked> VLDB</div>
                    <div><input type="checkbox" checked> ICDE</div>
                    <div><input type="checkbox" checked> PODS</div>
                </div>

                <div>
                    <input type="checkbox" checked> Design automation
                    <div><input type="checkbox" checked> DAC</div>
                    <div><input type="checkbox" checked> ICCAD</div>
                </div>

                <div>
                    <input type="checkbox" checked> Embedded & real-time systems
                    <div><input type="checkbox" checked> EMSOFT</div>
                    <div><input type="checkbox" checked> RTAS</div>
                    <div><input type="checkbox" checked> RTSS</div>
                </div>

                <div>
                    <input type="checkbox" checked> High-performance computing
                    <div><input type="checkbox" checked> HPDC</div>
                    <div><input type="checkbox" checked> ICS</div>
                    <div><input type="checkbox" checked> SC</div>
                </div>

                <div>
                    <input type="checkbox" checked> Mobile computing
                    <div><input type="checkbox" checked> MobiCom</div>
                    <div><input type="checkbox" checked> MobiSys</div>
                    <div><input type="checkbox" checked> SenSys</div>
                </div>

                <div>
                    <input type="checkbox" checked> Measurement & perf. analysis
                    <div><input type="checkbox" checked> IMC</div>
                    <div><input type="checkbox" checked> SIGMETRICS</div>
                </div>

                <div>
                    <input type="checkbox" checked> Operating systems
                    <div><input type="checkbox" checked> OSDI</div>
                    <div><input type="checkbox" checked> SOSP</div>
                    <div><input type="checkbox" checked> EuroSys</div>
                    <div><input type="checkbox" checked> FAST</div>
                    <div><input type="checkbox" checked> USENIX ATC</div>
                </div>

                <div>
                    <input type="checkbox" checked> Programming languages
                    <div><input type="checkbox" checked> PLDI</div>
                    <div><input type="checkbox" checked> POPL</div>
                    <div><input type="checkbox" checked> ICFP</div>
                    <div><input type="checkbox" checked> OOPSLA</div>
                </div>

                <div>
                    <input type="checkbox" checked> Software engineering
                    <div><input type="checkbox" checked> FSE</div>
                    <div><input type="checkbox" checked> ICSE</div>
                    <div><input type="checkbox" checked> ASE</div>
                    <div><input type="checkbox" checked> ISSTA</div>
                </div>
                <!-- Theory -->
                <input type="checkbox" checked> Theory

                <div>
                    <input type="checkbox" checked> Algorithms & complexity
                    <div><input type="checkbox" checked> FOCS</div>
                    <div><input type="checkbox" checked> SODA</div>
                    <div><input type="checkbox" checked> STOC</div>
                </div>

                <div>
                    <input type="checkbox" checked> Cryptography
                    <div><input type="checkbox" checked> CRYPTO</div>
                    <div><input type="checkbox" checked> EuroCrypt</div>
                </div>

                <div>
                    <input type="checkbox" checked> Logic & verification
                    <div><input type="checkbox" checked> CAV</div>
                    <div><input type="checkbox" checked> LICS</div>
                </div>
                <!-- Interdisciplinary Areas -->
                <input type="checkbox" checked> Interdisciplinary Areas

                <div>
                    <input type="checkbox" checked> Comp. bio & bioinformatics
                    <div><input type="checkbox" checked> ISMB</div>
                    <div><input type="checkbox" checked> RECOMB</div>
                </div>

                <div>
                    <input type="checkbox" checked> Computer graphics
                    <div><input type="checkbox" checked> SIGGRAPH</div>
                    <div><input type="checkbox" checked> SIGGRAPH Asia</div>
                    <div><input type="checkbox" checked> EUROGRAPHICS</div>
                </div>

                <div>
                    <input type="checkbox" checked> Computer science education
                    <div><input type="checkbox" checked> SIGCSE</div>
                </div>

                <div>
                    <input type="checkbox" checked> Economics & computation
                    <div><input type="checkbox" checked> EC</div>
                    <div><input type="checkbox" checked> WINE</div>
                </div>

                <div>
                    <input type="checkbox" checked> Human-computer interaction
                    <div><input type="checkbox" checked> CHI</div>
                    <div><input type="checkbox" checked> UbiComp / IMWUT</div>
                    <div><input type="checkbox" checked> UIST</div>
                </div>

                <div>
                    <input type="checkbox" checked> Robotics
                    <div><input type="checkbox" checked> ICRA</div>
                    <div><input type="checkbox" checked> IROS</div>
                    <div><input type="checkbox" checked> RSS</div>
                </div>

                <div>
                    <input type="checkbox" checked> Visualization
                    <div><input type="checkbox" checked> VIS</div>
                    <div><input type="checkbox" checked> VR</div>
                </div>
            </div>
        </div>
    </div>

    <script> 
        //draw chart w new data
        function drawChart(data) {

            //sort by parentOrder
            var parentOrder= ["AI", "Systems", "Theory", "Interdisciplinary Areas"];
            data.sort(function(a,b) {
                var pa = parentOrder.indexOf(a.parent_area);
                var pb = parentOrder.indexOf(b.parent_area);
                if(pa !== pb) return pa - pb;
                return a.area.localeCompare(b.area);
            });

            var areas = [];
            var values = [];
            var parents = [];
            for(var i = 0; i < data.length; i++) {
                var row = data[i];
                areas.push(row.area);
                values.push(row.iclr_points);
                parents.push(row.parent_area);
            };
            
            var colorMap = {
                "AI": "#1f77b4",
                "Systems": "#ff7f0e",
                "Theory": "#2ca02c",
                "Interdisciplinary Areas": "#d62728"
            };
            var barColors = parents.map(function(p){
                return colorMap[p] || "#999";
            });

            var trace = {
                type: "bar",
                x: values,
                y: areas,
                orientation: "h",
                marker: {color: barColors},
            };

            var layout = {
            margin: { l: 230, r: 30, t: 20, b: 30 },
            xaxis: { title: "ICLR Points" },
            yaxis: { automargin: true, title: "Area" },
            showlegend: false,
            height: 400 + data.length * 10
            };

            Plotly.newPlot("chart", [trace], layout, { displaylogo: false });
        }

        function getYearsFromInput() {
            var fromStr = document.getElementById("from-year").value.trim();
            var toStr = document.getElementById("to-year").value.trim();
            var fromYear = parseInt(fromStr);
            var toYear = parseInt(toStr);
            if (isNaN(fromYear)) fromYear = 2019;
            if (isNaN(toYear)) toYear = 2023;
            return { from: fromYear, to: toYear};
        }

        function loadData(fromYear, toYear){
            var url = "http://localhost:8001/iclr_points?from_year=" + fromYear + "&to_year=" + toYear;

            fetch(url)
            .then(function(response){
                return response.json();
            })
            .then(function(data){
                drawChart(data);
            });
        }

        function setup(){
            document.getElementById("from-year").value = "2019";
            document.getElementById("to-year").value = "2023";

            var btn = document.getElementById("update-range");
            btn.addEventListener("click", function(){
                var yrs = getYearsFromInput();
                loadData(yrs.from, yrs.to);
            });
        }
        setup();
    </script>
</body>
</html>